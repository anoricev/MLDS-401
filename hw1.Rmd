---
title: "MLDS 401: Homework 1"
output: pdf_document
date: "2025-09-18"
author: Arielle Weinstein, Jack Bailey, Junbo (Jacob) Lian, Veronica Lin
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1

```{r}
library(readr)
StockBeta <- read_csv("401-data/IBM-Apple-SP500 RR Data.csv", 
                      col_types = cols(`S&P 500` = col_number(), 
                                       IBM = col_number(), 
                                       Apple = col_number()), 
                      skip = 1)
StockBeta <- StockBeta[, -5]
summary(StockBeta)
```


### (a). Make scatter plots of rates of return of IBM versus S&P 500 and of Apple versus S&P 500 and comment on them.

```{r}
plot(StockBeta$IBM ~ StockBeta$"S&P 500", 
     main = "Monthly Return Rate of IBM versus S&P 500",
     xlab = "Monthly Return Rate (%) of S&P 500",
     ylab = "Monthly Return Rate (%) of IBM")
```

```{r}
plot(StockBeta$Apple ~ StockBeta$"S&P 500", 
     main = "Monthly Return Rate of Apple versus S&P 500",
     xlab = "Monthly Return Rate (%) of S&P 500",
     ylab = "Monthly Return Rate (%) of Apple")
```

### (b). Calculate the $\beta$'s for IBM and Apple with reference to S&P 500. Comment on the relative magnitudes of the $\beta$'s. Which stock had a higher expected return relative to S&P 500?

```{r}
ibm_fit <- lm(StockBeta$IBM ~ StockBeta$"S&P 500")
summary(ibm_fit)$coefficients

apple_fit <- lm(StockBeta$Apple ~ StockBeta$"S&P 500")
summary(apple_fit)$coefficients
```

### (c). Calculate the sample standard deviations (SDs) of the rates of return for S&P 500, IBM and Apple. Also calculate the correlation matrix. Check that $\beta$ = $rs_y/s_x$ for each stock where $r$ is the correlation coefficient between S&P 500 and the given stock, $s_x$ is the sample SD of S&P 500 and $s_y$ is the sample SD of the given stock.

```{r}
sd_ibm <- sd(StockBeta$IBM)
sd_ibm

sd_sp500 <- sd(StockBeta$"S&P 500")
sd_sp500

sd_apple <- sd(StockBeta$Apple)
sd_sp500
```

```{r}
cor(StockBeta[, c("S&P 500", "IBM", "Apple")])
```

```{r}
r_ibm <- cor(StockBeta$IBM, StockBeta$"S&P 500")
beta_ibm_check <- r_ibm * (sd_ibm / sd_sp500)
beta_ibm_check

r_apple <- cor(StockBeta$Apple, StockBeta$"S&P 500")
beta_apple_check <- r_apple * (sd_apple / sd_sp500)
beta_apple_check
```

### (d). Explain based on the statistics calculated how a higher expected return is accompanied by higher volatility of the Apple stock.



## Question 2

```{r}
auto <- read.table("~/Desktop/401-data/auto.txt", head=T)
auto$origin = factor(auto$origin, 1:3, c("US", "Europe", "Japan"))
summary(auto)
```

```{r}
model <- lm(mpg ~ horsepower, data = auto)
summary(model)
```

```{r}
auto$origin <- as.factor(auto$origin)
plot(auto$horsepower, auto$mpg,
     xlab = "Horsepower",
     ylab = "Miles per Gallon (mpg)",
     main = "Regression of mpg on horsepower by origin",
     pch = 20, col = auto$origin)
abline(model)
```

### (a). What is the estimated regression equation?

### (b) What does the slope tell you?

### (c) How much uncertainty is associated with the slope estimate?

### (d) What does the residual standard error tell you?

### (e) Using this model, is there a significant relationship between mpg and horsepower?

### (f) What fraction of the variation in mpg is explained by using this linear function of horsepower?

### (g) What is the predicted mpg associated with a horsepower of 98?

### (h) What is the 95% prediction interval for the predicted mpg associated with a horsepower of 98? For what types of questions would it be appropriate to look at the PI?

```{r}
predict(model, data.frame(horsepower = 98), interval = "prediction")
```

### (i) What is the 99% confidence interval for the mean prediction of mpg when horse- power is 98? For what types of questions would it be appropriate to look at the CI for mean prediction?

```{r}
predict(model, data.frame(horsepower = 98), interval = "confidence", level = 0.99)
```

### (j) What is a 90% confidence interval for the slope?

### (k) In looking at the scatterplot and fitted model, note any violations of the model assumptions


## Question 3

```{r}
library(psych)
pairs.panels(auto[,c(2:8,1)], stars=T, density=T) # part a
```

### a) (3 points) Based on the scatterplots, comment on the relationships between the predictors and mpg.

```{r}
round(cor(auto[,1:7], use="pair"),4) # part b
```

### (b) (2 points) What is the correlation between mpg and displacement and what does it tell you? Which variables have significant relationships with mpg?

```{r}
fit = lm(mpg~., auto[,1:8]) # part c
summary(fit)
```

### (c) (2 points) Is there a statistically significant relationship between the predictors and the response? (Hint: do the F test using the multiple regression output)

### (d) (2 points) Which predictors appear to have a statistically significant relationship to the response in the multiple regression?

### (e) (2 points) What does the slope coefficient for the year variable suggest?

### (f) (2 points) What does the slope coefficient for the displacement variable suggest?

